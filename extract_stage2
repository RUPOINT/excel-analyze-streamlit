import pandas as pd

def process_excel_stage2(df):
    """
    Оставляет только указанные колонки в DataFrame.
    Если каких-то колонок нет — просто пропускает их.
    """
    columns_to_keep = [
        "ND (Номер декларации)",
        "G141 (ИНН декларанта)",
        "G142 (Наименование декларанта)",
        "G143 (Адрес декларанта)",
        "G202 (Условие поставки)",
        "Декларант — количество деклараций",
        "Пустые ячейки в колонке брокера",
        "Количество брокеров",
        "Контакты"
    ]
    # Оставляем только существующие колонки
    cols = [col for col in columns_to_keep if col in df.columns]
    return df[cols].copy()
